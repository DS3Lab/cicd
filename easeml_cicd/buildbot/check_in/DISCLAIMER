Modified from: https://github.com/webknjaz/check-in/tree/master/check_in